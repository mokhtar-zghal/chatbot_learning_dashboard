{"ast":null,"code":"import { IntentAddEditComponent } from './emp-add-edit/intent-add-edit.component';\nimport { MatPaginator } from '@angular/material/paginator';\nimport { MatSort } from '@angular/material/sort';\nimport { MatTableDataSource } from '@angular/material/table';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/material/dialog\";\nimport * as i3 from \"./services/intent.service\";\nimport * as i4 from \"./core/core.service\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/material/toolbar\";\nimport * as i7 from \"@angular/material/icon\";\nimport * as i8 from \"@angular/material/button\";\nimport * as i9 from \"@angular/material/form-field\";\nimport * as i10 from \"@angular/material/input\";\nimport * as i11 from \"@angular/material/table\";\nimport * as i12 from \"@angular/material/paginator\";\nimport * as i13 from \"@angular/material/sort\";\nfunction AppComponent_th_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 18);\n    i0.ɵɵtext(1, \" Intent \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AppComponent_td_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 19);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const row_r12 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", row_r12.intent, \" \");\n  }\n}\nfunction AppComponent_th_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 18);\n    i0.ɵɵtext(1, \" Questions \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AppComponent_td_19_li_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const question_r15 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(question_r15.text);\n  }\n}\nfunction AppComponent_td_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 19)(1, \"ul\");\n    i0.ɵɵtemplate(2, AppComponent_td_19_li_2_Template, 2, 1, \"li\", 20);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const row_r13 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", row_r13.questions);\n  }\n}\nfunction AppComponent_th_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 18);\n    i0.ɵɵtext(1, \" Responses \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AppComponent_td_22_li_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const response_r18 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(response_r18.text);\n  }\n}\nfunction AppComponent_td_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 19)(1, \"ul\");\n    i0.ɵɵtemplate(2, AppComponent_td_22_li_2_Template, 2, 1, \"li\", 20);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const row_r16 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", row_r16.responses);\n  }\n}\nfunction AppComponent_th_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 18);\n    i0.ɵɵtext(1, \" Action \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AppComponent_td_25_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r21 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"td\", 19)(1, \"button\", 21);\n    i0.ɵɵlistener(\"click\", function AppComponent_td_25_Template_button_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r21);\n      const row_r19 = restoredCtx.$implicit;\n      const ctx_r20 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r20.openEditForm(row_r19));\n    });\n    i0.ɵɵelementStart(2, \"mat-icon\");\n    i0.ɵɵtext(3, \"edit\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"button\", 22);\n    i0.ɵɵlistener(\"click\", function AppComponent_td_25_Template_button_click_4_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r21);\n      const row_r19 = restoredCtx.$implicit;\n      const ctx_r22 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r22.deleteIntent(row_r19.intent));\n    });\n    i0.ɵɵelementStart(5, \"mat-icon\");\n    i0.ɵɵtext(6, \"delete\");\n    i0.ɵɵelementEnd()()();\n  }\n}\nfunction AppComponent_tr_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 23);\n  }\n}\nfunction AppComponent_tr_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 24);\n  }\n}\nfunction AppComponent_tr_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\", 25)(1, \"td\", 26);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    i0.ɵɵnextContext();\n    const _r0 = i0.ɵɵreference(11);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"No data matching the filter \\\"\", _r0.value, \"\\\"\");\n  }\n}\nconst _c0 = function () {\n  return [5, 10, 25, 100];\n};\nexport class AppComponent {\n  constructor(_http, _dialog, _intentService, _coreService) {\n    this._http = _http;\n    this._dialog = _dialog;\n    this._intentService = _intentService;\n    this._coreService = _coreService;\n    this.displayedColumns = ['intent', 'questions', 'responses', 'action'];\n    this.cc = [];\n  }\n  ngOnInit() {\n    this.cc = [];\n    this.getDictionaryList();\n    /*setTimeout(() => {\r\n      this.dataSource = new MatTableDataSource(this.cc);\r\n      this.dataSource.sort = this.sort;\r\n      this.dataSource.paginator = this.paginator;\r\n      console.log(this.cc.length);\r\n    }, 1500);*/\n  }\n\n  reload() {\n    console.log(this.cc.length);\n    this.dataSource = new MatTableDataSource(this.cc);\n    this.dataSource.sort = this.sort;\n    this.dataSource.paginator = this.paginator;\n  }\n  openAddEditIntentForm() {\n    const dialogRef = this._dialog.open(IntentAddEditComponent, {\n      width: '50%'\n    });\n    dialogRef.afterClosed().subscribe({\n      next: val => {\n        let data = {\n          intent: val.intent,\n          responses: val.responses.map(value => ({\n            text: value\n          })),\n          questions: val.questions.map(value => ({\n            text: value\n          }))\n        };\n        console.log(data);\n        this.cc.push(data);\n        this.dataSource = new MatTableDataSource(this.cc);\n        this.dataSource.sort = this.sort;\n        this.dataSource.paginator = this.paginator;\n      }\n    });\n  }\n  openEditForm(data) {\n    data = {\n      intent: data.intent,\n      questions: data.questions.map(q => q.text),\n      responses: data.responses.map(r => r.text)\n    };\n    const dialogRef = this._dialog.open(IntentAddEditComponent, {\n      width: '50%',\n      data\n    });\n    dialogRef.afterClosed().subscribe({\n      next: val => {\n        let data = {\n          intent: val.intent,\n          responses: val.responses.map(value => ({\n            text: value\n          })),\n          questions: val.questions.map(value => ({\n            text: value\n          }))\n        };\n        console.log(data);\n        this.cc = this.cc.filter(item => item.intent !== val.intent);\n        this.cc.push(data);\n        this.dataSource = new MatTableDataSource(this.cc);\n        this.dataSource.sort = this.sort;\n        this.dataSource.paginator = this.paginator;\n      }\n    });\n  }\n  getDictionaryList() {\n    this._intentService.getDialogNodesList().subscribe(data => {\n      data.dialog_nodes.map(node => {\n        this._intentService.getQuestionsList(node.title).subscribe(questions => {\n          const transformedNode = {\n            intent: node.title,\n            responses: node.output.generic[0].values,\n            questions: questions.examples.map(example => {\n              return {\n                text: example.text\n              };\n            })\n          };\n          this.cc.push(transformedNode);\n          this.dataSource = new MatTableDataSource(this.cc);\n          this.dataSource.sort = this.sort;\n          this.dataSource.paginator = this.paginator;\n        });\n      });\n    });\n  }\n  applyFilter(event) {\n    const filterValue = event.target.value;\n    this.dataSource.filter = filterValue.trim().toLowerCase();\n    if (this.dataSource.paginator) {\n      this.dataSource.paginator.firstPage();\n    }\n  }\n  deleteIntent(intent) {\n    console.log(intent);\n    this._intentService.deleteIntent(intent).subscribe({\n      next: () => {\n        this.cc = this.cc.filter(item => item.intent !== intent);\n        console.log(this.cc.length);\n        this.dataSource = new MatTableDataSource(this.cc);\n        this.dataSource.sort = this.sort;\n        this.dataSource.paginator = this.paginator;\n        this._coreService.openSnackBar('Intent deleted!', 'done');\n      },\n      error: console.log\n    });\n  }\n}\nAppComponent.ɵfac = function AppComponent_Factory(t) {\n  return new (t || AppComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.MatDialog), i0.ɵɵdirectiveInject(i3.IntentService), i0.ɵɵdirectiveInject(i4.CoreService));\n};\nAppComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: AppComponent,\n  selectors: [[\"app-root\"]],\n  viewQuery: function AppComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(MatPaginator, 5);\n      i0.ɵɵviewQuery(MatSort, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.paginator = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.sort = _t.first);\n    }\n  },\n  decls: 30,\n  vars: 5,\n  consts: [[\"color\", \"primary\"], [1, \"example-spacer\"], [\"mat-raised-button\", \"\", 3, \"click\"], [1, \"main-body\"], [\"matInput\", \"\", \"placeholder\", \"Intent(dictionary) name\", 3, \"keyup\"], [\"input\", \"\"], [1, \"table-container\"], [\"mat-table\", \"\", \"matSort\", \"\", 3, \"dataSource\"], [\"matColumnDef\", \"intent\"], [\"mat-header-cell\", \"\", \"mat-sort-header\", \"\", 4, \"matHeaderCellDef\"], [\"mat-cell\", \"\", 4, \"matCellDef\"], [\"matColumnDef\", \"questions\"], [\"matColumnDef\", \"responses\"], [\"matColumnDef\", \"action\"], [\"mat-header-row\", \"\", 4, \"matHeaderRowDef\"], [\"mat-row\", \"\", 4, \"matRowDef\", \"matRowDefColumns\"], [\"class\", \"mat-row\", 4, \"matNoDataRow\"], [\"aria-label\", \"Select page of intents\", 3, \"pageSizeOptions\"], [\"mat-header-cell\", \"\", \"mat-sort-header\", \"\"], [\"mat-cell\", \"\"], [4, \"ngFor\", \"ngForOf\"], [\"mat-icon-button\", \"\", \"color\", \"primary\", 3, \"click\"], [\"mat-icon-button\", \"\", \"color\", \"warn\", 3, \"click\"], [\"mat-header-row\", \"\"], [\"mat-row\", \"\"], [1, \"mat-row\"], [\"colspan\", \"4\", 1, \"mat-cell\"]],\n  template: function AppComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"mat-toolbar\", 0)(1, \"span\");\n      i0.ɵɵtext(2, \"chatbot Application\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(3, \"span\", 1);\n      i0.ɵɵelementStart(4, \"button\", 2);\n      i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_4_listener() {\n        return ctx.openAddEditIntentForm();\n      });\n      i0.ɵɵtext(5, \" Apprentissage chatbot \");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(6, \"div\", 3)(7, \"mat-form-field\")(8, \"mat-label\");\n      i0.ɵɵtext(9, \"Filter\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(10, \"input\", 4, 5);\n      i0.ɵɵlistener(\"keyup\", function AppComponent_Template_input_keyup_10_listener($event) {\n        return ctx.applyFilter($event);\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(12, \"div\", 6)(13, \"table\", 7);\n      i0.ɵɵelementContainerStart(14, 8);\n      i0.ɵɵtemplate(15, AppComponent_th_15_Template, 2, 0, \"th\", 9);\n      i0.ɵɵtemplate(16, AppComponent_td_16_Template, 2, 1, \"td\", 10);\n      i0.ɵɵelementContainerEnd();\n      i0.ɵɵelementContainerStart(17, 11);\n      i0.ɵɵtemplate(18, AppComponent_th_18_Template, 2, 0, \"th\", 9);\n      i0.ɵɵtemplate(19, AppComponent_td_19_Template, 3, 1, \"td\", 10);\n      i0.ɵɵelementContainerEnd();\n      i0.ɵɵelementContainerStart(20, 12);\n      i0.ɵɵtemplate(21, AppComponent_th_21_Template, 2, 0, \"th\", 9);\n      i0.ɵɵtemplate(22, AppComponent_td_22_Template, 3, 1, \"td\", 10);\n      i0.ɵɵelementContainerEnd();\n      i0.ɵɵelementContainerStart(23, 13);\n      i0.ɵɵtemplate(24, AppComponent_th_24_Template, 2, 0, \"th\", 9);\n      i0.ɵɵtemplate(25, AppComponent_td_25_Template, 7, 0, \"td\", 10);\n      i0.ɵɵelementContainerEnd();\n      i0.ɵɵtemplate(26, AppComponent_tr_26_Template, 1, 0, \"tr\", 14);\n      i0.ɵɵtemplate(27, AppComponent_tr_27_Template, 1, 0, \"tr\", 15);\n      i0.ɵɵtemplate(28, AppComponent_tr_28_Template, 3, 1, \"tr\", 16);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(29, \"mat-paginator\", 17);\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(13);\n      i0.ɵɵproperty(\"dataSource\", ctx.dataSource);\n      i0.ɵɵadvance(13);\n      i0.ɵɵproperty(\"matHeaderRowDef\", ctx.displayedColumns);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"matRowDefColumns\", ctx.displayedColumns);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"pageSizeOptions\", i0.ɵɵpureFunction0(4, _c0));\n    }\n  },\n  dependencies: [i5.NgForOf, i6.MatToolbar, i7.MatIcon, i8.MatButton, i8.MatIconButton, i9.MatFormField, i9.MatLabel, i10.MatInput, i11.MatTable, i11.MatHeaderCellDef, i11.MatHeaderRowDef, i11.MatColumnDef, i11.MatCellDef, i11.MatRowDef, i11.MatHeaderCell, i11.MatCell, i11.MatHeaderRow, i11.MatRow, i11.MatNoDataRow, i12.MatPaginator, i13.MatSort, i13.MatSortHeader],\n  styles: [\".example-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.main-body[_ngcontent-%COMP%]{padding-top:20px;margin:0 auto;max-width:1348px}.main-body[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.action[_ngcontent-%COMP%]{display:flex;gap:5px}\"]\n});","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}